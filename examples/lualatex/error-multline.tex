\documentclass{article}
\usepackage{amsmath}
\begin{document}
\def\test{
  \directlua{
    local lparse = require('lparse')
    local oarg, marg = lparse.scan('O{} v')
    print(oarg, marg)
  }
}
% 1	590
% 2	19
% 	12
%
% ! Missing } inserted.
% <inserted text>
%                 }
% l.25 \end{multline*}
\begin{multline*}
p(x) = \test[1]{590}x^4y^2 + \test[2]{19}x^3y^3\\
- 12x^2y^4 - \test {12}xy^5
\end{multline*}
\end{document}
