\input lparse.tex

\def\test{\par\directlua{
  local oarg, star, marg = lparse.scan('o s m')
  tex.print('o: ' .. tostring(oarg))
  tex.print('s: ' .. tostring(star))
  tex.print('m: ' .. tostring(marg))
}% Important: after \directlua no characters to expand
}

\test{marg} % o: nil s: false m: marg
\test[oarg]{marg} % o: oarg s: false m: marg
\test[oarg]*{marg} % o: oarg s: true m: marg

\bye
