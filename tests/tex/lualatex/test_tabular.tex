\documentclass{article}
\begin{document}

\def\test{
  \directlua{
    local lparse = require('lparse')
    local oarg, marg = lparse.scan('O{} v')
    print(oarg, marg)
    tex.print(marg)
  }
}

\begin{tabular}{ll}
\test[oarg]{marg} & \test{marg} \\
\end{tabular}

\end{document}
